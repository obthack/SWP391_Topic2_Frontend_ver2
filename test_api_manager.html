<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Manager Test - EVTB</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .btn-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            padding: 12px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 6px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
            margin-top: 15px;
        }

        .output pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .success {
            color: #4ade80;
        }

        .error {
            color: #f87171;
        }

        .info {
            color: #60a5fa;
        }

        .warning {
            color: #fbbf24;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-card h3 {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }

        .stat-card p {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .clear-btn {
            background: #ef4444;
            margin-top: 10px;
        }

        .clear-btn:hover {
            background: #dc2626;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            background: #667eea;
            color: white;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 10px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>🚀 API Manager Test</h1>
        <p class="subtitle">
            Test tổng hợp các API endpoints từ apiManager.js
            <span class="badge">v2.0</span>
        </p>

        <!-- Stats -->
        <div class="stats">
            <div class="stat-card">
                <h3>Total APIs</h3>
                <p id="totalApis">65+</p>
            </div>
            <div class="stat-card">
                <h3>Modules</h3>
                <p id="totalModules">15</p>
            </div>
            <div class="stat-card">
                <h3>Success Rate</h3>
                <p id="successRate">-</p>
            </div>
            <div class="stat-card">
                <h3>Tests Run</h3>
                <p id="testsRun">0</p>
            </div>
        </div>

        <!-- Authentication Section -->
        <div class="section">
            <h2>🔐 Authentication APIs</h2>
            <div class="input-group">
                <label>Email:</label>
                <input type="email" id="loginEmail" placeholder="user@example.com" value="test@example.com">
            </div>
            <div class="input-group">
                <label>Password:</label>
                <input type="password" id="loginPassword" placeholder="Password" value="password123">
            </div>
            <div class="btn-group">
                <button onclick="testLogin()">🔑 Login</button>
                <button onclick="testRegister()">📝 Register</button>
                <button onclick="testRefreshToken()">🔄 Refresh Token</button>
                <button onclick="testForgotPassword()">❓ Forgot Password</button>
            </div>
        </div>

        <!-- Product Section -->
        <div class="section">
            <h2>🚗 Product APIs</h2>
            <div class="input-group">
                <label>Product ID:</label>
                <input type="number" id="productId" placeholder="1" value="1">
            </div>
            <div class="btn-group">
                <button onclick="testGetAllProducts()">📋 Get All Products</button>
                <button onclick="testGetProductById()">🔍 Get Product by ID</button>
                <button onclick="testCreateProduct()">➕ Create Product</button>
                <button onclick="testUpdateProduct()">✏️ Update Product</button>
                <button onclick="testSearchProducts()">🔎 Search Products</button>
            </div>
        </div>

        <!-- Order Section -->
        <div class="section">
            <h2>📦 Order APIs</h2>
            <div class="input-group">
                <label>Order ID:</label>
                <input type="number" id="orderId" placeholder="1" value="1">
            </div>
            <div class="btn-group">
                <button onclick="testGetAllOrders()">📋 Get All Orders</button>
                <button onclick="testGetOrderById()">🔍 Get Order by ID</button>
                <button onclick="testCreateOrder()">➕ Create Order</button>
                <button onclick="testUpdateOrderStatus()">✏️ Update Status</button>
            </div>
        </div>

        <!-- Payment Section -->
        <div class="section">
            <h2>💳 Payment APIs</h2>
            <div class="btn-group">
                <button onclick="testCreatePayment()">💰 Create Payment</button>
                <button onclick="testGetPaymentById()">🔍 Get Payment</button>
                <button onclick="testVNPayFlow()">🏦 Test VNPay Flow</button>
            </div>
        </div>

        <!-- Favorite Section -->
        <div class="section">
            <h2>❤️ Favorite APIs</h2>
            <div class="btn-group">
                <button onclick="testToggleFavorite()">⭐ Toggle Favorite</button>
                <button onclick="testGetFavorites()">📋 Get Favorites</button>
                <button onclick="testIsFavorited()">❔ Check Favorited</button>
            </div>
        </div>

        <!-- Verification Section -->
        <div class="section">
            <h2>✅ Verification APIs</h2>
            <div class="btn-group">
                <button onclick="testRequestVerification()">📝 Request Verification</button>
                <button onclick="testGetVerificationRequests()">📋 Get Requests</button>
                <button onclick="testUpdateVerificationStatus()">✏️ Update Status</button>
            </div>
        </div>

        <!-- Statistics Section -->
        <div class="section">
            <h2>📊 Statistics APIs</h2>
            <div class="btn-group">
                <button onclick="testGetDashboardStats()">📈 Dashboard Stats</button>
                <button onclick="testGetAdminStats()">👑 Admin Stats</button>
                <button onclick="testGetProductStats()">📊 Product Stats</button>
            </div>
        </div>

        <!-- Batch Operations -->
        <div class="section">
            <h2>⚡ Batch Operations</h2>
            <div class="btn-group">
                <button onclick="testBatchFetch()">🔄 Batch Fetch Products</button>
                <button onclick="testParallelRequests()">⚡ Parallel Requests</button>
            </div>
        </div>

        <!-- Output -->
        <div class="section">
            <h2>📝 Console Output</h2>
            <div class="output" id="output">
                <pre>Waiting for API calls...</pre>
            </div>
            <button class="clear-btn" onclick="clearOutput()">🗑️ Clear Output</button>
        </div>
    </div>

    <script type="module">
        // Import API Manager
        // Note: Adjust import path based on your project structure
        // import api from './src/api/index.js';

        // For testing without build, we'll create mock functions
        window.api = {
            auth: {
                login: async (credentials) => {
                    log('🔑 Calling api.auth.login()...', 'info');
                    // Mock response
                    await delay(500);
                    return {
                        token: 'mock_jwt_token_123456',
                        user: { id: 1, email: credentials.email, name: 'Test User' }
                    };
                },
                register: async (data) => {
                    log('📝 Calling api.auth.register()...', 'info');
                    await delay(500);
                    return { success: true, message: 'User registered successfully' };
                },
                refreshToken: async () => {
                    log('🔄 Calling api.auth.refreshToken()...', 'info');
                    await delay(300);
                    return { token: 'new_mock_token_789' };
                },
                forgotPassword: async (email) => {
                    log('❓ Calling api.auth.forgotPassword()...', 'info');
                    await delay(400);
                    return { success: true, message: 'Reset email sent' };
                }
            },
            product: {
                getAll: async () => {
                    log('📋 Calling api.product.getAll()...', 'info');
                    await delay(600);
                    return [
                        { id: 1, name: 'Tesla Model 3', price: 1200000000 },
                        { id: 2, name: 'VinFast VF8', price: 1100000000 },
                        { id: 3, name: 'Tesla Model Y', price: 1500000000 }
                    ];
                },
                getById: async (id) => {
                    log(`🔍 Calling api.product.getById(${id})...`, 'info');
                    await delay(400);
                    return { id, name: 'Tesla Model 3', price: 1200000000, status: 'Active' };
                },
                create: async (data) => {
                    log('➕ Calling api.product.create()...', 'info');
                    await delay(500);
                    return { id: 999, ...data, status: 'Pending' };
                },
                update: async (id, data) => {
                    log(`✏️ Calling api.product.update(${id})...`, 'info');
                    await delay(400);
                    return { id, ...data, updatedAt: new Date() };
                }
            },
            order: {
                getAll: async () => {
                    log('📋 Calling api.order.getAll()...', 'info');
                    await delay(600);
                    return [
                        { id: 1, productId: 1, status: 'Pending', amount: 1200000000 },
                        { id: 2, productId: 2, status: 'Completed', amount: 1100000000 }
                    ];
                },
                getById: async (id) => {
                    log(`🔍 Calling api.order.getById(${id})...`, 'info');
                    await delay(400);
                    return { id, productId: 1, status: 'Pending', amount: 1200000000 };
                },
                create: async (data) => {
                    log('➕ Calling api.order.create()...', 'info');
                    await delay(500);
                    return { id: 999, ...data, status: 'Pending' };
                },
                updateStatus: async (id, status) => {
                    log(`✏️ Calling api.order.updateStatus(${id}, ${status})...`, 'info');
                    await delay(400);
                    return { id, status, updatedAt: new Date() };
                }
            },
            payment: {
                create: async (data) => {
                    log('💰 Calling api.payment.create()...', 'info');
                    await delay(500);
                    return { id: 999, ...data, status: 'Pending' };
                },
                getById: async (id) => {
                    log(`🔍 Calling api.payment.getById(${id})...`, 'info');
                    await delay(400);
                    return { id, amount: 1200000000, status: 'Completed' };
                },
                processVNPay: async (data) => {
                    log('🏦 Calling api.payment.processVNPay()...', 'info');
                    await delay(600);
                    return { paymentUrl: 'https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?...' };
                }
            },
            favorite: {
                toggle: async (userId, productId) => {
                    log(`⭐ Calling api.favorite.toggle(${userId}, ${productId})...`, 'info');
                    await delay(400);
                    return { success: true, isFavorited: true };
                },
                getByUser: async (userId) => {
                    log(`📋 Calling api.favorite.getByUser(${userId})...`, 'info');
                    await delay(500);
                    return [{ userId, productId: 1 }, { userId, productId: 3 }];
                },
                isFavorited: async (userId, productId) => {
                    log(`❔ Calling api.favorite.isFavorited(${userId}, ${productId})...`, 'info');
                    await delay(300);
                    return true;
                }
            },
            verification: {
                request: async (productId) => {
                    log(`📝 Calling api.verification.request(${productId})...`, 'info');
                    await delay(500);
                    return { success: true, message: 'Verification requested' };
                },
                getRequests: async () => {
                    log('📋 Calling api.verification.getRequests()...', 'info');
                    await delay(600);
                    return [
                        { productId: 1, status: 'Requested', requestedAt: new Date() },
                        { productId: 5, status: 'InProgress', requestedAt: new Date() }
                    ];
                },
                updateStatus: async (productId, status) => {
                    log(`✏️ Calling api.verification.updateStatus(${productId}, ${status})...`, 'info');
                    await delay(400);
                    return { productId, status, updatedAt: new Date() };
                }
            },
            statistics: {
                getDashboard: async (userId) => {
                    log(`📈 Calling api.statistics.getDashboard(${userId})...`, 'info');
                    await delay(600);
                    return {
                        totalProducts: 15,
                        totalOrders: 8,
                        totalRevenue: 9600000000,
                        pendingOrders: 2
                    };
                },
                getAdmin: async () => {
                    log('👑 Calling api.statistics.getAdmin()...', 'info');
                    await delay(700);
                    return {
                        totalUsers: 150,
                        totalProducts: 450,
                        totalOrders: 320,
                        totalRevenue: 384000000000,
                        activeUsers: 98
                    };
                },
                getProduct: async (productId) => {
                    log(`📊 Calling api.statistics.getProduct(${productId})...`, 'info');
                    await delay(500);
                    return {
                        views: 1250,
                        favorites: 45,
                        orders: 3,
                        revenue: 3600000000
                    };
                }
            },
            search: {
                products: async (params) => {
                    log('🔎 Calling api.search.products()...', 'info');
                    await delay(600);
                    return [
                        { id: 1, name: 'Tesla Model 3', price: 1200000000 },
                        { id: 3, name: 'Tesla Model Y', price: 1500000000 }
                    ];
                }
            }
        };

        let testsRun = 0;
        let successCount = 0;

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type;

            const line = `<span class="${colorClass}">[${timestamp}] ${message}</span>`;

            if (output.innerHTML === '<pre>Waiting for API calls...</pre>') {
                output.innerHTML = `<pre>${line}</pre>`;
            } else {
                output.innerHTML += `\n${line}`;
            }

            output.scrollTop = output.scrollHeight;
        }

        function logObject(obj, label = 'Response') {
            log(`${label}:`, 'info');
            log(JSON.stringify(obj, null, 2), 'success');
        }

        function updateStats(success = true) {
            testsRun++;
            if (success) successCount++;

            document.getElementById('testsRun').textContent = testsRun;
            const successRate = ((successCount / testsRun) * 100).toFixed(1);
            document.getElementById('successRate').textContent = successRate + '%';
        }

        // Test Functions
        window.testLogin = async function () {
            try {
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;

                const response = await window.api.auth.login({ email, password });
                logObject(response, 'Login Response');
                log('✅ Login successful!', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Login failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testRegister = async function () {
            try {
                const response = await window.api.auth.register({
                    email: 'newuser@example.com',
                    password: 'password123',
                    fullName: 'Test User',
                    phone: '0123456789'
                });
                logObject(response, 'Register Response');
                log('✅ Registration successful!', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Registration failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testRefreshToken = async function () {
            try {
                const response = await window.api.auth.refreshToken();
                logObject(response, 'Refresh Token Response');
                log('✅ Token refreshed!', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Token refresh failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testForgotPassword = async function () {
            try {
                const email = document.getElementById('loginEmail').value;
                const response = await window.api.auth.forgotPassword(email);
                logObject(response, 'Forgot Password Response');
                log('✅ Reset email sent!', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Forgot password failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetAllProducts = async function () {
            try {
                const products = await window.api.product.getAll();
                logObject(products, 'Products');
                log(`✅ Fetched ${products.length} products`, 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch products: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetProductById = async function () {
            try {
                const id = parseInt(document.getElementById('productId').value);
                const product = await window.api.product.getById(id);
                logObject(product, 'Product');
                log('✅ Product fetched successfully', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch product: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testCreateProduct = async function () {
            try {
                const product = await window.api.product.create({
                    name: 'Tesla Model S',
                    price: 2000000000,
                    description: 'Luxury electric sedan'
                });
                logObject(product, 'Created Product');
                log('✅ Product created successfully', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to create product: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testUpdateProduct = async function () {
            try {
                const id = parseInt(document.getElementById('productId').value);
                const product = await window.api.product.update(id, {
                    price: 1150000000
                });
                logObject(product, 'Updated Product');
                log('✅ Product updated successfully', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to update product: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testSearchProducts = async function () {
            try {
                const results = await window.api.search.products({
                    keyword: 'Tesla',
                    minPrice: 1000000000,
                    maxPrice: 2000000000
                });
                logObject(results, 'Search Results');
                log(`✅ Found ${results.length} products`, 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Search failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetAllOrders = async function () {
            try {
                const orders = await window.api.order.getAll();
                logObject(orders, 'Orders');
                log(`✅ Fetched ${orders.length} orders`, 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch orders: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetOrderById = async function () {
            try {
                const id = parseInt(document.getElementById('orderId').value);
                const order = await window.api.order.getById(id);
                logObject(order, 'Order');
                log('✅ Order fetched successfully', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch order: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testCreateOrder = async function () {
            try {
                const order = await window.api.order.create({
                    userId: 1,
                    productId: 1,
                    totalAmount: 1200000000
                });
                logObject(order, 'Created Order');
                log('✅ Order created successfully', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to create order: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testUpdateOrderStatus = async function () {
            try {
                const id = parseInt(document.getElementById('orderId').value);
                const order = await window.api.order.updateStatus(id, 'Confirmed');
                logObject(order, 'Updated Order');
                log('✅ Order status updated', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to update order: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testCreatePayment = async function () {
            try {
                const payment = await window.api.payment.create({
                    orderId: 1,
                    amount: 1200000000,
                    paymentMethod: 'VNPay'
                });
                logObject(payment, 'Created Payment');
                log('✅ Payment created successfully', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to create payment: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetPaymentById = async function () {
            try {
                const payment = await window.api.payment.getById(1);
                logObject(payment, 'Payment');
                log('✅ Payment fetched successfully', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch payment: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testVNPayFlow = async function () {
            try {
                const response = await window.api.payment.processVNPay({
                    orderId: 1,
                    amount: 1200000000
                });
                logObject(response, 'VNPay Response');
                log('⚠️ Would redirect to: ' + response.paymentUrl, 'warning');
                log('✅ VNPay flow initiated', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ VNPay flow failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testToggleFavorite = async function () {
            try {
                const result = await window.api.favorite.toggle(1, 1);
                logObject(result, 'Toggle Result');
                log('✅ Favorite toggled', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to toggle favorite: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetFavorites = async function () {
            try {
                const favorites = await window.api.favorite.getByUser(1);
                logObject(favorites, 'Favorites');
                log(`✅ Fetched ${favorites.length} favorites`, 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch favorites: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testIsFavorited = async function () {
            try {
                const isFavorited = await window.api.favorite.isFavorited(1, 1);
                log(`Is Favorited: ${isFavorited}`, 'info');
                log('✅ Check completed', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Check failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testRequestVerification = async function () {
            try {
                const result = await window.api.verification.request(1);
                logObject(result, 'Verification Request');
                log('✅ Verification requested', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to request verification: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetVerificationRequests = async function () {
            try {
                const requests = await window.api.verification.getRequests();
                logObject(requests, 'Verification Requests');
                log(`✅ Fetched ${requests.length} requests`, 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch requests: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testUpdateVerificationStatus = async function () {
            try {
                const result = await window.api.verification.updateStatus(1, 'Completed');
                logObject(result, 'Updated Status');
                log('✅ Status updated', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to update status: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetDashboardStats = async function () {
            try {
                const stats = await window.api.statistics.getDashboard(1);
                logObject(stats, 'Dashboard Stats');
                log('✅ Stats fetched successfully', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch stats: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetAdminStats = async function () {
            try {
                const stats = await window.api.statistics.getAdmin();
                logObject(stats, 'Admin Stats');
                log('✅ Admin stats fetched', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch admin stats: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testGetProductStats = async function () {
            try {
                const id = parseInt(document.getElementById('productId').value);
                const stats = await window.api.statistics.getProduct(id);
                logObject(stats, 'Product Stats');
                log('✅ Product stats fetched', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Failed to fetch product stats: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testBatchFetch = async function () {
            try {
                log('🔄 Starting batch fetch...', 'info');
                const productIds = [1, 2, 3];

                const products = await Promise.all(
                    productIds.map(id => window.api.product.getById(id))
                );

                logObject(products, 'Batch Fetch Results');
                log(`✅ Fetched ${products.length} products in parallel`, 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Batch fetch failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.testParallelRequests = async function () {
            try {
                log('⚡ Starting parallel requests...', 'info');

                const [products, orders, stats] = await Promise.all([
                    window.api.product.getAll(),
                    window.api.order.getAll(),
                    window.api.statistics.getDashboard(1)
                ]);

                log(`Products: ${products.length}`, 'success');
                log(`Orders: ${orders.length}`, 'success');
                logObject(stats, 'Stats');
                log('✅ All parallel requests completed', 'success');
                updateStats(true);
            } catch (error) {
                log(`❌ Parallel requests failed: ${error.message}`, 'error');
                updateStats(false);
            }
        };

        window.clearOutput = function () {
            document.getElementById('output').innerHTML = '<pre>Output cleared. Ready for new tests...</pre>';
        };

        // Initialize
        log('🚀 API Manager Test Interface Ready', 'success');
        log('Click any button to test API endpoints', 'info');
        log('───────────────────────────────────────', 'info');
    </script>
</body>

</html>